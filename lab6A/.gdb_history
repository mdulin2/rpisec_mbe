set follow-fork-mode child
searchmem "/bin/sh" 0xbfaae000 0xbfacf000
x/3x $esp 
x/3w $esp 
disas 0xb760e1e0
x/x 0xbfacd13c
set {int}0xbfacd17c = 0xbface9c5
x/3w $esp 
d 1
d 2
c
c
c
q
r <payload 
qq
q
r <payload 
set follow-fork-mode child
r <payload 
q
r < payload 
set follow-fork-mode child
r < payload 
q
r < payload 
q
r < payload 
set follow-fork-mode child
r < payload 
q
r < payload 
q
r < payload 
q
r < payload 
set follow-fork-mode child
r < payload 
q
q
disas main
b *0x080484fc
disas system
r < payload
x/3x $esp 
q
b *0x080484fc
r < payload
x/3x $esp 
x/x 0xbfff000a
q
r < payload
b *s
disas main
b *0x080484fc
r < payload
x/x $esp 
x/3x $esp 
x/x 0xbffff668
q
r < payload
disas m
disas main
b *0x080484fc
r < payload
cx/x $esp 
x/x $esp 
x/3x $esp 
q
r < payload
b *0x080484fc
r < payload
x/3x $esp 
q
r < payload
b *0x080484fc
r < payload
exit
q
b *0x080484fc
r < payload
x/x $esp 
x/3x $esp 
q
r < payload
q
r < payload
set follow-fork-mode child
r < payload
q
disas main
x/x 0x0804842d
b *0x0804842d
q
disas main
x/x 0x0804842d
b *0x0804842d
r
x/3x $esp 
s
x/3x $esp 
q
q
disas main
b *0x080484fc
r < payload 
s
x/x $esp 
x/3x $esp 
x/x $ebp
q
b *0x0804842d
disas main
r
s
info registers 

d 1
exit
set follow-fork-mode child
r < payload
r < payload
disas main
exit
exit
q
set follow-fork-mode child
b *0x0804842d
r
s
set $ebp =0x41414141
c
d 1
c
q
disas exit
r < payload 
disas exit
p exit
exit
q
disas exit
disas system
break *main
r < payload
disas system
disas exit
q
b * main
r
disas system
q
q
r < payload 
set follow-fork-mode child
r < payload 
q
r < payload 
set follow-fork-mode child
r < payload 
q
set follow-fork-mode child
r < payload 
set follow-fork-mode child
r < payload 
q
r < payload 
q
r < payload 
ls
r < payload 
q
r < payload 
ls
q
r < payload 
q
r < payload 
ls
q
disas main
b *0x080484fc
r < payload 
x/x $esp 
x/3x $esp 
x/3x 0xbffff658
x/s 0xbffff658
x/s 0xbffff668
x/20 $esp 
x/20s $esp 
q
r < payload 
set follow-fork-mode child
r < payload 
q
set follow-fork-mode child
r < payload 
q
disas system
q
disas exit
q
disas read
disas system
break main
r
disas system
q
q
r < payload 
disas main
b * 0x08048540
r < payload 
x/x $esp 
x/2x $esp 
x/2x $esp - 4
q
r < payload 
q
q
q
q
r < payload 
q
b * 0x08048540
r < payload 
x/x $esp 
s
q
b *0x080484fc
r < payload 
q
disas main
b *0x08048540
r < payload 
x/x $esp 
x/3x $esp 
x/x $esp 
x/40x $esp 
x/40s $esp 
x/40s $esp - 20
x/40s $esp-20
x/40s $esp-40
x/40s $esp-60
x/3x
x/3w $esp 
set {int}0xbffff700 = 0xbffff6c8
x/3w $esp 
x/3w $esp + 8
set {int}0xbffff704 = 0xbffff6c8
x/3w $esp 
c
d 1
r < payload 
r < payload 
q
